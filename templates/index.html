<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ config.app_title }}</title>
  <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
  <div class="container">
    <header>
      <img src="{{ config.logo_path }}" alt="App Logo" class="header-logo">
      <h2>{{ config.app_title }}</h2>
      <p>{{ config.app_description }}</p>
    </header>

    <div class="main-layout">
        <nav class="sidebar">
            <ul>
                <li><a href="#" id="show-new-feedback">Neue Frage</a></li>
                <li><a href="#" id="show-existing">Bestehende Fragen</a></li>
                <li><a href="{{ url_for('show_table') }}" id="show-table-nav">Feedback-Tabelle</a></li>
            </ul>
        </nav>
        
        <div class="content-area">
            <section id="new-feedback-section" class="content-section">
                <h2>Neue Frage stellen</h2>
                <form id="feedback-form" action="/submit" method="post">
                    <input type="text" name="question" placeholder="Ihre Frage oder Ihr Feedback" required>
                    <textarea name="description" placeholder="Detaillierte Beschreibung (optional)"></textarea>
                    
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="text" id="user-name-input" name="name" placeholder="Ihr Name (optional)" readonly>
                        <i class="fas fa-edit" id="edit-name-icon" title="Namen bearbeiten"></i>
                        <span id="upvoter-id-display" style="display: none;"></span>
                        <i class="fas fa-eye" id="toggle-upvoter-id-display-icon" title="Ihre ID anzeigen/verbergen"></i>
                    </div>

                    <button type="submit">Frage einreichen</button>
                </form>
            </section>

            <section id="existing-feedback-section" class="content-section active">
                <h2>Bestehende Fragen</h2>
                <div class="explanation-text">
                    <p>Hier können Sie bestehende Fragen und Feedback-Einträge sehen und bewerten. Klicken Sie auf den Pfeil neben einer Beschreibung, um sie vollständig anzuzeigen.</p>
                </div>
                <div class="feedback-list">
                    <ul class="feedback-items">
                        {% for fb in feedbacks %}
                        <li class="feedback-item">
                            <div class="feedback-votes">
                                <a href="{{ url_for('vote_feedback', fid=fb['id'], direction='up', upvoter_id_param='PLACEHOLDER_ID', upvoter_name_param='PLACEHOLDER_NAME') }}" class="vote-button upvote" data-fid="{{ fb['id'] }}" data-direction="up">▲</a>
                                <span class="vote-count">{{ fb['votes'] }}</span>
                                <a href="{{ url_for('vote_feedback', fid=fb['id'], direction='down', upvoter_id_param='PLACEHOLDER_ID', upvoter_name_param='PLACEHOLDER_NAME') }}" class="vote-button downvote" data-fid="{{ fb['id'] }}" data-direction="down">▼</a>
                            </div>
                            <div class="feedback-content">
                                <div class="question-wrapper">
                                    <p class="feedback-question">{{ fb['question'] }}</p>
                                </div>
                                {% if fb['description'] %}
                                <div class="description-wrapper">
                                    <span class="description-toggle-arrow" data-expanded="false">▶</span> {# Pfeil zeigt standardmäßig nach rechts #}
                                    <p class="feedback-description collapsed">{{ fb['description'] }}</p>
                                </div>
                                {% endif %}
                                <p class="feedback-meta">
                                    Von: {{ fb['name'] }} | Eingereicht: {{ fb['timestamp'] }}
                                </p>
                                {% if fb['upvoter_names_list'] %}
                                <p class="all-upvoters-list">
                                    Unterstützer:inen: {{ fb['upvoter_names_list'] | join(', ') }}
                                </p>
                                {% endif %}
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    {% if not feedbacks %}
                        <p class="no-feedback">Noch keine Fragen oder Feedback-Einträge vorhanden.</p>
                    {% endif %}
                </div>
            </section>
        </div>
    </div>
  </div>

  <script src="{{ url_for('static', path='script.js') }}"></script>
</body>
</html>